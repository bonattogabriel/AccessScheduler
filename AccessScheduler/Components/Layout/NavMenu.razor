@rendermode InteractiveServer
@inject IJSRuntime JSRuntime

<nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4">
    <div class="container">
        <a class="navbar-brand" href="#">
            <i class="bi bi-calendar-check me-2"></i>
            Agendador de Acessos
        </a>
        <button class="btn btn-outline-light" @onclick="OpenNewSession">
            <i class="bi bi-plus-circle me-1"></i>
            Nova Sessão (Teste Concorrência)
        </button>
    </div>
</nav>

@code {
    private async Task OpenNewSession()
    {
        try
        {
            await JSRuntime.InvokeVoidAsync("open", "/", "_blank");
        }
        catch (JSException jsEx)
        {
            try
            {
                await JSRuntime.InvokeVoidAsync("eval", "window.open('/', '_blank')");
            }
            catch
            {
                await JSRuntime.InvokeVoidAsync("alert", "Não foi possível abrir nova janela. Verifique se pop-ups estão permitidos.");
            }
        }
        catch (Exception ex)
        {
            await JSRuntime.InvokeVoidAsync("alert", $"Erro: {ex.Message}");
        }
    }
}